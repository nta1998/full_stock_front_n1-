<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

    
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <div style="padding-left: 2%;padding-top:2%">
        <div style="padding-right: 60%;">
        <div class="input-group input-group-sm mb-3">
            <span class="input-group-text" >name</span>
            <input type="text" id="pname" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
        </div>
        <div class="input-group input-group-sm mb-3">
            <span class="input-group-text" >email</span>
            <input type="email" id="pemail" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
        </div>
        <div class="input-group input-group-sm mb-3">
            <span class="input-group-text" >phone number</span>
            <input type="number" id="pnumber"class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
        </div>
        <div class="input-group input-group-sm mb-3">
            <span class="input-group-text" >favorite color</span>
            <input type="color" id="pcolor" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
        </div>
    </div>
    <button class="btn btn-success" onclick="add()">add person</button>
    <button class="btn btn-info" onclick="show_all()">show all</button>
<br>
<br>    
</div>
    <div id="view"></div>
    <script>
        const MY_SERVER = 'https://colorf.onrender.com/add'

        const show_all=async()=>{
             await axios.get(MY_SERVER).then((res) => view.innerHTML= res.data.map((pr,i) => `
             <div class="accordion accordion-flush">
            <div class="accordion-item">
            <h2 class="accordion-header">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse${i}">
            ${pr.name}
            </button>
            </h2>
            <div id="flush-collapse${i}" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
            <div class="accordion-body">email: ${pr.email}<br>phone number:${pr.phone_number}<br>favorite color:<div style="background-color: ${pr.favorite_color};">${pr.favorite_color} </div></h1><br><button class="btn btn-success" onclick="upd(${pr.id})">update</button> <button class="btn btn-danger" onclick="del(${pr.id})">delete</button></div>
            </div>
            </div>
            </div>`).join(" "))
        }
        const add=()=>{
            axios.post(MY_SERVER+'/',{name: pname.value, email: pemail.value, phone_number: pnumber.value, favorite_color: pcolor.value})
            .then((res) => console.log(res.data))
            show_all()
        }
        const del=(id)=>{
            axios.delete(MY_SERVER+'/'+id).then(console.log('del'))
            show_all()
        }
        const upd=(id)=>{
            axios.put(MY_SERVER+'/'+id,{name: pname.value, email: pemail.value, phone_number: pnumber.value, favorite_color: pcolor.value})
            show_all()
        }
        show_all()
    </script>
</body>
</html>